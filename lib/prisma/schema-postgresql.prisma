datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client"
    output   = "../src/generated/prisma"
}

enum Role {
    student
    teacher
    vicePrincipal
    principal
}

enum Grade {
    tenth
    eleventh
    twelfth
}

enum Major {
    accounting
    softwareEngineering
}

model User {
    id            String    @id @default(cuid())
    name          String
    grade         Grade
    major         Major
    email         String    @unique
    password      String?
    emailVerified DateTime?
    isVerified    Boolean
    image         String?
    sessions      Session[]
    role          Role      @default(student)

    otp             String?
    otpExpiresAt    DateTime?
    otpRequestCount Int       @default(0)
    otpResetAt      DateTime?
    otpAttemptCount Int       @default(0)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Session {
    sessionToken String   @unique
    userId       String
    expires      DateTime
    user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model VerificationToken {
    identifier String
    token      String
    expires    DateTime

    @@id([identifier, token])
}
